<!DOCTYPE html>
<html lang="en">

<%- include('./layouts/header') %>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <%- include('./layouts/sidebar') %>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <%- include('./layouts/topbar') %>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="h4 text-gray-800">Available Jobs</h2>
                        <a href="/jobs/create/new" class="btn btn-success btn-sm shadow-sm">
                            <i class="fas fa-plus me-1"></i> Add Job
                        </a>
                    </div>

                    <!-- Flash Message -->
                    <% if (message && message.length > 0) { %>
                        <div class="alert alert-info"><%= message %></div>
                    <% } %>

                    <!-- Jobs Grid -->
                    <div class="row">
                        <% if (jobs.length === 0) { %>
                            <div class="col-12">
                                <div class="alert alert-warning">No jobs available at the moment.</div>
                            </div>
                        <% } %>

                        <% jobs.forEach(job => { %>
                            <div class="col-md-4 mb-4">
                                <div class="card h-100 shadow-sm border-left-primary">
                                    
                                    <!-- Job Image -->
                                    <% if (job.image) { %>
                                        <img src="<%= job.image %>" 
                                             class="card-img-top" 
                                             alt="<%= job.title %>" 
                                             style="height:200px; object-fit:cover;">
                                    <% } else { %>
                                        <img src="/images/no-job.png" 
                                             class="card-img-top" 
                                             alt="No Image" 
                                             style="height:200px; object-fit:cover;">
                                    <% } %>

                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title"><%= job.title %></h5>
                                        <p class="text-muted mb-1">
                                            <small><strong>Budget:</strong> $<%= job.budget %> | 
                                            <strong>Status:</strong> <%= job.status || "Open" %></small>
                                        </p>
                                        <p class="text-muted mb-2">
                                            <small><strong>Skills:</strong> <%= job.skills?.join(', ') || "None" %></small>
                                        </p>
                                        <p class="card-text flex-grow-1">
                                            <%= job.description.length > 100 ? job.description.substring(0, 100) + "..." : job.description %>
                                        </p>
                                        <p class="text-end text-muted mb-2">
                                            <small>Posted on: <%= job.createdAt.toDateString() %></small>
                                        </p>
                                        <div class="d-flex justify-content-between">
                                            <a href="/jobs/<%= job._id %>" class="btn btn-primary btn-sm">
                                                <i class="fas fa-eye"></i>View Details
                                            </a>
                                            <a href="/jobs/edit/<%= job._id %>" class="btn btn-warning btn-sm">
                                                <i class="fas fa-edit"></i>Edit
                                            </a>
                                            <form action="/jobs/delete/<%= job._id %>"
                                                                    method="POST"
                                                                    onsubmit="return confirm('Are you sure you want to delete this job?')">
                                                                    <button type="submit" class="btn btn-danger btn-sm">
                                                                        <i class="fas fa-trash"></i> Delete
                                                                    </button>
                                                                </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <%- include('./layouts/footer') %>

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

</body>

</html>
